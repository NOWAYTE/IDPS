from scapy.all import IP, TCP, UDP, Raw, wrpcap

packets = [
    # Match: Signature - mqtt_exploit
    IP(dst="127.0.0.1")/TCP(sport=1883, dport=80)/Raw(load=bytes.fromhex("4D5154544578706C6F6974")),
    
    # Match: Signature - coap_flood
    IP(dst="127.0.0.1")/UDP(sport=5683, dport=5683)/Raw(load=bytes.fromhex("436F4150466C6F6F64")),
    
    # Normal HTTP packet
    IP(dst="127.0.0.1")/TCP(sport=12345, dport=80)/Raw(load=b"GET / HTTP/1.1\r\n\r\n"),
    
    # Random benign packet
    IP(dst="127.0.0.1")/UDP(sport=5000, dport=5001)/Raw(load=b"NormalStuff")
]

wrpcap("tests/traffic.pcap", packets)
print("âœ… sample_traffic.pcap generated in tests/")
