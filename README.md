Intrusion detection and prevention system 